---
import navConfig from '../data/navigation.json';

const { pathname } = Astro.url;
---

<nav class="bg-blue-950 shadow-sm border-b border-blue-900 sticky top-[97px] z-40">
    <div class="max-w-6xl mx-auto px-6">
        <div class="flex space-x-1 overflow-x-auto md:overflow-visible py-4 items-center">
            {navConfig.navigation.map((item, index) => {
                // Add divider after "How It Works" (index 1)
                const showDivider = index === 2;
                const isMarketing = item.category === 'marketing';
                const isDeveloper = item.category === 'developer';
                
                return (
                    <>
                        {showDivider && (
                            <div class="h-8 w-px bg-gradient-to-b from-transparent via-slate-500 to-transparent mx-4 hidden md:block"></div>
                        )}
                        <div class="relative group">
                            <button class={`nav-link flex items-center space-x-1 px-3 py-2 rounded-lg transition-all ${
                                isMarketing ? 'hover:bg-indigo-900/30 hover:text-cyan-300' : 
                                isDeveloper ? 'hover:bg-green-900/30 hover:text-purple-300' : 
                                'hover:bg-slate-800'
                            }`}>
                                <span set:html={item.icon} />
                                <span class="whitespace-nowrap">{item.label}</span>
                                <svg class="w-4 h-4 opacity-70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <!-- Dropdown Menu -->
                            <div class={`absolute left-0 mt-2 w-72 bg-slate-900 border rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-left z-50 ${
                                isMarketing ? 'border-indigo-700/50' : 
                                isDeveloper ? 'border-green-700/50' : 
                                'border-slate-700'
                            }`}>
                                <div class="py-2">
                                    {item.children.map(child => (
                                        <a href={child.url}
                                            class={`block px-4 py-3 text-sm transition-colors ${
                                                isMarketing ? 'text-slate-300 hover:bg-indigo-900/40 hover:text-cyan-200' : 
                                                isDeveloper ? 'text-slate-300 hover:bg-green-900/40 hover:text-purple-200' : 
                                                'text-slate-300 hover:bg-slate-800 hover:text-white'
                                            }`}>
                                            <div class="font-medium">{child.label}</div>
                                            {child.description && (
                                                <div class="text-xs text-slate-400 mt-0.5">{child.description}</div>
                                            )}
                                        </a>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </>
                );
            })}
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="md:hidden hidden bg-blue-950 border-t border-blue-900">
        <div class="px-6 py-4 space-y-4">
            {navConfig.navigation.map((item, index) => {
                const showDivider = index === 2;
                const isMarketing = item.category === 'marketing';
                
                return (
                    <>
                        {showDivider && (
                            <div class="border-t border-slate-700 my-4"></div>
                        )}
                        <div class="space-y-2">
                            <div class={`text-xs font-semibold uppercase tracking-wider pl-2 ${
                                isMarketing ? 'text-cyan-400' : 'text-purple-400'
                            }`}>{item.label}</div>
                            {item.children.map(child => (
                                <a href={child.url} class="mobile-nav-link pl-6 border-l-2 border-slate-700">
                                    {child.label}
                                </a>
                            ))}
                        </div>
                    </>
                );
            })}
        </div>
    </div>
</nav>

<style>
    .mobile-nav-link {
        @apply block px-4 py-2 text-slate-300 hover:bg-slate-800 hover:text-white transition-colors rounded-lg text-sm;
    }
    
    .nav-link {
        @apply text-slate-200 font-medium;
    }
</style>
